<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>水波纹效果 | 梦飞翔的小站</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/assets/style.93999ffb.css">
    <link rel="modulepreload" href="/assets/app.73cabeba.js">
    <link rel="modulepreload" href="/assets/posts_ripple-animation.md.e0f08259.lean.js">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/regular.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC">
  <script src="https://cdn.jsdelivr.net/npm/@waline/client@1.5.4/dist/Waline.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><!--[--><header><span class="brand"></span><span class="container"><span class="menu"><ul><!--[--><li><a href="/"><span><i class="fa fa-home"></i> 首页</span></a></li><li><a href="/tags/"><span><i class="fa fa-tag"></i> 标签</span></a></li><li><a href="/readme.html"><span><i class="fa fa-leaf"></i> 关于</span></a></li><!--]--></ul></span></span><span class="other"><a class="search"><i class="fa fa-search"></i></a></span></header><aside></aside><main><a href="#" class="totop" style="top:-900px;" aria-label="to-top"></a><!--[--><div class="abanner" style="background-image: url(https://tva4.sinaimg.cn/large/0060lm7Tly1ftg6omnqa4j31hc0u010z.jpg)"><div class="titlebox"><h1 class="title">水波纹效果</h1><div class="info">flaribbit · 更新于 2022-05-20 · 0 次阅读</div></div></div><div class="article"><div style="position:relative;" class="content"><div><p>js + css 实现水波纹效果</p><hr><p>突然想实现一个水波纹效果，于是就有了这篇文章。</p><div class="ripple"></div><h2 id="思路分析" tabindex="-1">思路分析 <a class="header-anchor" href="#思路分析" aria-hidden="true">#</a></h2><p>思路比较简单，在容器内创建一个用于绘制水波纹的元素，然后放大就可以了。</p><h2 id="实现" tabindex="-1">实现 <a class="header-anchor" href="#实现" aria-hidden="true">#</a></h2><p>实现过程中发现主要的难点是半径的计算。</p><p>需要圆形完全覆盖矩形，也就是说圆的半径要大于等于到四个顶点的距离，把这四个距离求最大值就可以了。</p><p>进一步思考，只需计算出到左侧和右侧距离的最大值，和上方和下方距离的最大值，勾股定理即可。</p><div class="language-ts line-numbers-mode"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">maxH</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">max</span><span style="color:#24292F;">(e.offsetX, el.clientWidth </span><span style="color:#CF222E;">-</span><span style="color:#24292F;"> e.offsetX)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">maxV</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">max</span><span style="color:#24292F;">(e.offsetY, el.clientHeight </span><span style="color:#CF222E;">-</span><span style="color:#24292F;"> e.offsetY)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">radius</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">sqrt</span><span style="color:#24292F;">(maxH </span><span style="color:#CF222E;">**</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">2</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">+</span><span style="color:#24292F;"> maxV </span><span style="color:#CF222E;">**</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">2</span><span style="color:#24292F;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>完整代码如下：</p><div class="language-html line-numbers-mode"><button class="copy"></button><span class="lang">html</span><pre><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">class</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;ripple&quot;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">@mousedown</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;onClick&quot;</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">setup</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">lang</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;ts&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">onClick</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> (</span><span style="color:#953800;">e</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#953800;">MouseEvent</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">el</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> e.currentTarget </span><span style="color:#CF222E;">as</span><span style="color:#24292F;"> </span><span style="color:#953800;">HTMLElement</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">circle</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> document.</span><span style="color:#8250DF;">createElement</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;span&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">maxH</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">max</span><span style="color:#24292F;">(e.offsetX, el.clientWidth </span><span style="color:#CF222E;">-</span><span style="color:#24292F;"> e.offsetX)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">maxV</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">max</span><span style="color:#24292F;">(e.offsetY, el.clientHeight </span><span style="color:#CF222E;">-</span><span style="color:#24292F;"> e.offsetY)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">radius</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Math.</span><span style="color:#8250DF;">sqrt</span><span style="color:#24292F;">(maxH </span><span style="color:#CF222E;">**</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">2</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">+</span><span style="color:#24292F;"> maxV </span><span style="color:#CF222E;">**</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">2</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">  circle.className </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;ripple-circle&#39;</span></span>
<span class="line"><span style="color:#24292F;">  circle.style.left </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">`${</span><span style="color:#24292F;">e</span><span style="color:#0A3069;">.</span><span style="color:#24292F;">offsetX</span><span style="color:#0A3069;"> </span><span style="color:#CF222E;">-</span><span style="color:#0A3069;"> </span><span style="color:#24292F;">radius</span><span style="color:#0A3069;">}px`</span></span>
<span class="line"><span style="color:#24292F;">  circle.style.top </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">`${</span><span style="color:#24292F;">e</span><span style="color:#0A3069;">.</span><span style="color:#24292F;">offsetY</span><span style="color:#0A3069;"> </span><span style="color:#CF222E;">-</span><span style="color:#0A3069;"> </span><span style="color:#24292F;">radius</span><span style="color:#0A3069;">}px`</span></span>
<span class="line"><span style="color:#24292F;">  circle.style.width </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">`${</span><span style="color:#24292F;">radius</span><span style="color:#0A3069;"> </span><span style="color:#CF222E;">*</span><span style="color:#0A3069;"> </span><span style="color:#0550AE;">2</span><span style="color:#0A3069;">}px`</span></span>
<span class="line"><span style="color:#24292F;">  circle.style.height </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">`${</span><span style="color:#24292F;">radius</span><span style="color:#0A3069;"> </span><span style="color:#CF222E;">*</span><span style="color:#0A3069;"> </span><span style="color:#0550AE;">2</span><span style="color:#0A3069;">}px`</span></span>
<span class="line"><span style="color:#24292F;">  el.</span><span style="color:#8250DF;">appendChild</span><span style="color:#24292F;">(circle)</span></span>
<span class="line"><span style="color:#24292F;">  circle.</span><span style="color:#8250DF;">addEventListener</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;animationend&#39;</span><span style="color:#24292F;">, () </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    el.</span><span style="color:#8250DF;">removeChild</span><span style="color:#24292F;">(circle)</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">style</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#0550AE;">.ripple</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">width</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">200</span><span style="color:#CF222E;">px</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">height</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">80</span><span style="color:#CF222E;">px</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">margin</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">auto</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">border</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">1</span><span style="color:#CF222E;">px</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">solid</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">#ccc</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">position</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">relative</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">overflow</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">hidden</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0550AE;">.ripple-circle</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">position</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">absolute</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">background-color</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">rgba</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">0</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">0</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">0</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">0.15</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">border-radius</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">50</span><span style="color:#CF222E;">%</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">transform-origin</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">center</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">animation</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">0.7</span><span style="color:#CF222E;">s</span><span style="color:#24292F;"> ripple-animation </span><span style="color:#0550AE;">ease</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">forwards</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">pointer-events</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">none</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">@keyframes</span><span style="color:#24292F;"> </span><span style="color:#953800;">ripple-animation</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">0%</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">opacity</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">1</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">transform</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">scale</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">0</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">50%</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">opacity</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">1</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">100%</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">opacity</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">0</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">transform</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">scale</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">1</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">style</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div></div></div><div class="content nav"><span><a href="/posts/tetris-field-compress.html"><i class="fa fa-angle-left"></i> 俄罗斯方块场地压缩</a></span><span><a href="/posts/call-cpp-from-python.html">在 python 中调用 c++ <i class="fa fa-angle-right"></i></a></span></div><div id="waline"></div><div class="toc"><ol><!--[--><li class="h2 active"><a href="#思路分析">思路分析</a></li><li class="h2"><a href="#实现">实现</a></li><!--]--></ol></div></div><!--]--></main><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"e304eee0\",\"posts_algorithm-2048.md\":\"c980a68d\",\"posts_algorithm-template.md\":\"b4bf7798\",\"posts_ascii-art.md\":\"96025e00\",\"posts_calc-demo.md\":\"40e2ff34\",\"posts_call-cpp-from-python.md\":\"31f5b503\",\"posts_cpp-promise.md\":\"88320393\",\"posts_d3-note.md\":\"b83cbba6\",\"posts_dev-on-windows.md\":\"d422a86c\",\"posts_fix-matplotlib-chinese.md\":\"1fa087c6\",\"posts_fn_in_rust.md\":\"75875f3f\",\"posts_indexeddb.md\":\"3a9eb75e\",\"posts_love2d-require-c-library.md\":\"92fbbc6c\",\"posts_new-to-arch.md\":\"edbf84b2\",\"posts_pattern-recognition-note.md\":\"c5d27e4a\",\"posts_pyside2-quick-start.md\":\"d1c50878\",\"posts_python-opencv.md\":\"0641cb51\",\"posts_ripple-animation.md\":\"e0f08259\",\"posts_rust-list-slice.md\":\"c032ee50\",\"posts_tensorflow-note.md\":\"a01e00ed\",\"posts_tetris-field-compress.md\":\"761c6123\",\"posts_write-code-from-answer.md\":\"d01614f6\",\"posts_xjb-utils.md\":\"5bad001b\",\"readme.md\":\"b3f60d09\",\"tags_index.md\":\"50978065\"}")</script>
    <script type="module" async src="/assets/app.73cabeba.js"></script>
    
  </body>
</html>